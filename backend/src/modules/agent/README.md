# ReAct Agent ç³»ç»Ÿ

## æ¦‚è¿°

ReAct Agent æ˜¯ä¸€ä¸ªåŸºäº ReActï¼ˆReasoning + Actingï¼‰æ¡†æ¶çš„æ™ºèƒ½ä»»åŠ¡æ‰§è¡Œç³»ç»Ÿï¼Œç”¨äºæ›¿æ¢åŸæœ‰çš„ä»»åŠ¡æµåŠŸèƒ½ã€‚æ–°ç³»ç»Ÿæä¾›äº†æ›´å¼ºå¤§çš„æ¨ç†èƒ½åŠ›ã€æ›´æ¸…æ™°çš„æ‰§è¡Œæµç¨‹å’Œæ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚

## æ ¸å¿ƒç‰¹æ€§

### ğŸ§  ç»“æ„åŒ–æ¨ç†
- **æ¨ç†å¼•æ“**: åŸºäºå¤§æ¨¡å‹çš„æ™ºèƒ½æ¨ç†ï¼Œæ”¯æŒå¤šæ­¥éª¤æ€è€ƒ
- **å†³ç­–åˆ¶å®š**: è‡ªåŠ¨åˆ†æä»»åŠ¡éœ€æ±‚å¹¶åˆ¶å®šæ‰§è¡Œç­–ç•¥
- **ç½®ä¿¡åº¦è¯„ä¼°**: æ¯ä¸ªå†³ç­–éƒ½æœ‰ç½®ä¿¡åº¦è¯„åˆ†ï¼Œç¡®ä¿æ‰§è¡Œè´¨é‡

### ğŸ› ï¸ æ™ºèƒ½è¡ŒåŠ¨æ‰§è¡Œ
- **å·¥å…·è°ƒç”¨**: è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„å·¥å…·å¹¶å‡†å¤‡å‚æ•°
- **é”™è¯¯å¤„ç†**: æ™ºèƒ½é‡è¯•æœºåˆ¶å’Œé”™è¯¯æ¢å¤ç­–ç•¥
- **æ‰§è¡Œç›‘æ§**: å®æ—¶ç›‘æ§å·¥å…·æ‰§è¡ŒçŠ¶æ€å’Œç»“æœ

### ğŸ‘ï¸ ç»“æœè§‚å¯Ÿåˆ†æ
- **æ´å¯Ÿæå–**: ä»æ‰§è¡Œç»“æœä¸­æå–å…³é”®ä¿¡æ¯å’Œæ´å¯Ÿ
- **å½±å“åˆ†æ**: è¯„ä¼°ç»“æœå¯¹åç»­æ­¥éª¤çš„å½±å“
- **é—®é¢˜è¯†åˆ«**: è‡ªåŠ¨è¯†åˆ«æ‰§è¡Œè¿‡ç¨‹ä¸­çš„é—®é¢˜å’Œé£é™©

### ğŸ”„ æ‰§è¡Œåæ€ä¼˜åŒ–
- **è¿‡ç¨‹åæ€**: å¯¹æ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹è¿›è¡Œæ·±å…¥åæ€
- **ç»éªŒæ€»ç»“**: æå–æˆåŠŸç»éªŒå’Œå¤±è´¥æ•™è®­
- **ç­–ç•¥ä¼˜åŒ–**: åŸºäºåæ€ç»“æœä¼˜åŒ–åç»­æ‰§è¡Œç­–ç•¥

## ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ReAct Agent   â”‚    â”‚  Agent Service  â”‚    â”‚  Agent Tools    â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  Reasoning  â”‚ â”‚    â”‚ â”‚ Session Mgmtâ”‚ â”‚    â”‚ â”‚ agent_task  â”‚ â”‚
â”‚ â”‚   Engine    â”‚ â”‚    â”‚ â”‚             â”‚ â”‚    â”‚ â”‚             â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚   Action    â”‚ â”‚    â”‚ â”‚ Progress    â”‚ â”‚    â”‚ â”‚agent_status â”‚ â”‚
â”‚ â”‚ Executor    â”‚ â”‚    â”‚ â”‚ Tracking    â”‚ â”‚    â”‚ â”‚             â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚Observation  â”‚ â”‚    â”‚ â”‚ Error       â”‚ â”‚    â”‚ â”‚ agent_stop  â”‚ â”‚
â”‚ â”‚   Engine    â”‚ â”‚    â”‚ â”‚ Handling    â”‚ â”‚    â”‚ â”‚             â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ ¸å¿ƒç»„ä»¶

### 1. ReActAgent
ä¸»è¦çš„Agentç±»ï¼Œè´Ÿè´£åè°ƒæ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹ï¼š
- ä»»åŠ¡åˆ†æå’Œè§„åˆ’
- ReActå¾ªç¯æ‰§è¡Œ
- çŠ¶æ€ç®¡ç†å’Œè¿›åº¦è·Ÿè¸ª
- ç»“æœç”Ÿæˆå’Œæ€»ç»“

### 2. ReasoningEngine
æ¨ç†å¼•æ“ï¼Œè´Ÿè´£æ™ºèƒ½æ¨ç†å’Œå†³ç­–ï¼š
- ç»“æ„åŒ–æ€è€ƒè¿‡ç¨‹
- å†³ç­–åˆ¶å®šå’Œè¯„ä¼°
- ç½®ä¿¡åº¦è®¡ç®—
- å¤‡é€‰æ–¹æ¡ˆç”Ÿæˆ

### 3. ActionExecutor
è¡ŒåŠ¨æ‰§è¡Œå™¨ï¼Œè´Ÿè´£å·¥å…·è°ƒç”¨å’Œè¡ŒåŠ¨æ‰§è¡Œï¼š
- å·¥å…·é€‰æ‹©å’Œå‚æ•°å‡†å¤‡
- æ‰§è¡Œè®¡åˆ’ç”Ÿæˆ
- å·¥å…·è°ƒç”¨æ‰§è¡Œ
- é”™è¯¯å¤„ç†å’Œé‡è¯•

### 4. ObservationEngine
è§‚å¯Ÿå¼•æ“ï¼Œè´Ÿè´£ç»“æœåˆ†æå’Œæ´å¯Ÿæå–ï¼š
- æ‰§è¡Œç»“æœåˆ†æ
- å…³é”®ä¿¡æ¯æå–
- å½±å“è¯„ä¼°
- é—®é¢˜è¯†åˆ«

### 5. AgentService
AgentæœåŠ¡ï¼Œæä¾›ä¼šè¯ç®¡ç†å’ŒæœåŠ¡æ¥å£ï¼š
- ä¼šè¯ç”Ÿå‘½å‘¨æœŸç®¡ç†
- è¿›åº¦äº‹ä»¶å¤„ç†
- é”™è¯¯å¤„ç†å’Œæ¢å¤
- ç»“æœä¿å­˜å’ŒæŸ¥è¯¢

## ä½¿ç”¨æ–¹å¼

### 1. é€šè¿‡å·¥å…·è°ƒç”¨
```typescript
// å¯åŠ¨Agentä»»åŠ¡
const result = await toolManager.executeTool('agent_task', {
  task: 'åˆ†æç³»ç»Ÿæ€§èƒ½',
  goal: 'ç”Ÿæˆæ€§èƒ½ä¼˜åŒ–å»ºè®®',
  enable_reflection: true,
  max_steps: 10,
  confidence_threshold: 0.7
});
```

### 2. é€šè¿‡æœåŠ¡æ¥å£
```typescript
// å¯åŠ¨Agentä»»åŠ¡
const sessionId = await agentService.startAgentTask(
  'åˆ†æç³»ç»Ÿæ€§èƒ½',
  'ç”Ÿæˆæ€§èƒ½ä¼˜åŒ–å»ºè®®',
  conversationId,
  {
    onProgress: (event) => {
      console.log('è¿›åº¦:', event.message);
    },
    onComplete: (result) => {
      console.log('å®Œæˆ:', result.summary);
    }
  }
);
```

### 3. ç›´æ¥ä½¿ç”¨Agent
```typescript
// åˆ›å»ºAgentå®ä¾‹
const agent = new ReActAgent({
  maxSteps: 10,
  enableReflection: true,
  confidenceThreshold: 0.7
});

// æ‰§è¡Œä»»åŠ¡
const result = await agent.executeTask(
  'åˆ†æç³»ç»Ÿæ€§èƒ½',
  'ç”Ÿæˆæ€§èƒ½ä¼˜åŒ–å»ºè®®',
  context,
  {
    onProgress: (event) => console.log(event.message),
    onError: (error) => console.error(error.message)
  }
);
```

## é…ç½®é€‰é¡¹

### AgentConfig
```typescript
interface AgentConfig {
  maxSteps: number;              // æœ€å¤§æ‰§è¡Œæ­¥éª¤æ•°
  maxRetries: number;            // æœ€å¤§é‡è¯•æ¬¡æ•°
  timeout: number;               // è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
  enableReflection: boolean;     // æ˜¯å¦å¯ç”¨åæ€
  enableMemory: boolean;         // æ˜¯å¦å¯ç”¨è®°å¿†
  enableProgressTracking: boolean; // æ˜¯å¦å¯ç”¨è¿›åº¦è·Ÿè¸ª
  reasoningModel: string;        // æ¨ç†æ¨¡å‹
  actionModel: string;           // è¡ŒåŠ¨æ¨¡å‹
  reflectionModel: string;       // åæ€æ¨¡å‹
  confidenceThreshold: number;   // ç½®ä¿¡åº¦é˜ˆå€¼
}
```

## äº‹ä»¶ç³»ç»Ÿ

### è¿›åº¦äº‹ä»¶
- `step_start`: æ­¥éª¤å¼€å§‹
- `step_complete`: æ­¥éª¤å®Œæˆ
- `step_error`: æ­¥éª¤é”™è¯¯
- `progress_update`: è¿›åº¦æ›´æ–°
- `status_change`: çŠ¶æ€å˜åŒ–

### é”™è¯¯äº‹ä»¶
- `tool_error`: å·¥å…·è°ƒç”¨é”™è¯¯
- `reasoning_error`: æ¨ç†é”™è¯¯
- `planning_error`: è§„åˆ’é”™è¯¯
- `execution_error`: æ‰§è¡Œé”™è¯¯
- `validation_error`: éªŒè¯é”™è¯¯

## ä¸æ—§ç³»ç»Ÿçš„å¯¹æ¯”

| ç‰¹æ€§ | æ—§ä»»åŠ¡æµ | æ–°Agentç³»ç»Ÿ |
|------|----------|-------------|
| æ¶æ„ | ç®€å•çš„å¾ªç¯æ‰§è¡Œ | ReActæ¡†æ¶ |
| æ¨ç† | åŸºç¡€æç¤ºè¯ | ç»“æ„åŒ–æ¨ç†å¼•æ“ |
| é”™è¯¯å¤„ç† | ç®€å•é‡è¯• | æ™ºèƒ½é”™è¯¯æ¢å¤ |
| è¿›åº¦è·Ÿè¸ª | åŸºç¡€çŠ¶æ€ | è¯¦ç»†è¿›åº¦äº‹ä»¶ |
| åæ€èƒ½åŠ› | æ—  | å†…ç½®åæ€æœºåˆ¶ |
| å¯æ‰©å±•æ€§ | æœ‰é™ | é«˜åº¦å¯æ‰©å±• |
| ç”¨æˆ·ä½“éªŒ | ä¸€èˆ¬ | ä¼˜ç§€ |

## è¿ç§»æŒ‡å—

### ä»ä»»åŠ¡æµè¿ç§»åˆ°Agent

1. **æ›¿æ¢å·¥å…·è°ƒç”¨**
   ```typescript
   // æ—§æ–¹å¼
   await toolManager.executeTool('task_flow', { task, goal });
   
   // æ–°æ–¹å¼
   await toolManager.executeTool('agent_task', { task, goal });
   ```

2. **æ›´æ–°äº‹ä»¶ç›‘å¬**
   ```typescript
   // æ—§äº‹ä»¶
   socket.on('task_flow:start', handler);
   socket.on('task_flow:status', handler);
   
   // æ–°äº‹ä»¶
   socket.on('agent:start', handler);
   socket.on('agent:progress', handler);
   ```

3. **æ›´æ–°çŠ¶æ€ç®¡ç†**
   ```typescript
   // æ—§çŠ¶æ€
   const taskFlowSession = global.taskFlowHandler.taskFlowSession;
   
   // æ–°çŠ¶æ€
   const agentSession = agentService.getSession(sessionId);
   ```

## æµ‹è¯•

è¿è¡ŒAgentç³»ç»Ÿæµ‹è¯•ï¼š
```bash
cd backend/src/modules/agent
npx ts-node test-agent.ts
```

## æ³¨æ„äº‹é¡¹

1. **æ€§èƒ½è€ƒè™‘**: Agentç³»ç»Ÿæ¯”æ—§ä»»åŠ¡æµæ›´å¤æ‚ï¼Œéœ€è¦æ›´å¤šè®¡ç®—èµ„æº
2. **æ¨¡å‹ä¾èµ–**: éœ€è¦ç¡®ä¿æ¨ç†ã€è¡ŒåŠ¨ã€åæ€æ¨¡å‹éƒ½å¯ç”¨
3. **é”™è¯¯å¤„ç†**: æ–°ç³»ç»Ÿæœ‰æ›´å®Œå–„çš„é”™è¯¯å¤„ç†ï¼Œä½†ä»éœ€è¦ç›‘æ§
4. **é…ç½®è°ƒä¼˜**: æ ¹æ®å®é™…ä½¿ç”¨æƒ…å†µè°ƒæ•´é…ç½®å‚æ•°

## æœªæ¥è®¡åˆ’

- [ ] æ”¯æŒå¹¶è¡Œæ‰§è¡Œå¤šä¸ªAgent
- [ ] æ·»åŠ Agenté—´é€šä¿¡æœºåˆ¶
- [ ] å®ç°AgentçŸ¥è¯†åº“
- [ ] æ”¯æŒè‡ªå®šä¹‰æ¨ç†ç­–ç•¥
- [ ] æ·»åŠ å¯è§†åŒ–è°ƒè¯•ç•Œé¢
